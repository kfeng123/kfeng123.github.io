---
layout: post
title: "后验贝叶斯因子与分类"
date: 2014-12-12 17:37:00
categories: math
---

好久没写blog，在家里电脑上写这篇日志出了2个问题：写完这篇日志后就build不起来了。查了半天不知为什么，就去gitpage上看了一圈，终于解决了，原来是编码问题，一定要用utf8无BOM。长见识了。还有一个问题就是jekyll引擎好像把latex里的一些竖线给解析成表格了，很烦人，想了半天，终于找到了一个“完美”解决方法：把latex代码包裹在一个b标签里，这能让jekyll不要解析。bootstrap大概是把b标签的css设没了，所以加不加这个标签，外表看不出来。(^_^)

>关于blog，近期抽空做一下这几件事：

>1. 改css，右边加个标签导航比较好

>2. 最好换个不用cdn的tex引擎吧

>3. 代码高亮引擎修整一下比较好


下面正题

---------

###后验贝叶斯因子与分类

贝叶斯因子是用来做检验问题的。实际上就是贝叶斯框架下的似然比。

设$$x_1,...,x_n\sim N(\mu_1,\Sigma)\ \ y_1,...,y_m\sim N(\mu_2,\Sigma)$$是两组训练样本及总体，其中参数均未知。然后给出一个观测$$z$$，我们去判断它属于总体1还是死总体2。

**普通的似然比**是这样：

>$$\frac {f(z|\mu_1,\Sigma)}{f(z|\mu_2,\Sigma)}$$

>它大于某个临界值时判给总体1 。

但它的问题在于似然比（可能）依赖于未知参数，常规的做法是把估计插进去<b>$$\frac {f(z|\hat\mu_1,\hat\Sigma)}{f(z|\hat\mu_2,\hat\Sigma)}$$</b>

**贝叶斯因子**不是把估计插进未知参数，而是把它用先验分布积掉。

>$$\frac {\int f(z|\mu_1,\Sigma)\pi (\mu_1,\mu_2,\Sigma )d\mu_1 d\mu_2d\Sigma}{\int f(z|\mu_2,\Sigma)\pi (\mu_1,\mu_2,\Sigma )d\mu_1 d\mu_2d\Sigma}$$

但是和检验问题不同，在分类问题中，我们根本没法凭空确定先验，所以不可行。可行的想法是用后验分布积分，也就变成 了**后验贝叶斯因子**：

>$$\frac {\int f(z|\mu_1,\Sigma)\pi (\mu_1,\mu_2,\Sigma |x,y)d\mu_1 d\mu_2d\Sigma}{\int f(z|\mu_2,\Sigma)\pi (\mu_1,\mu_2,\Sigma |x,y)d\mu_1 d\mu_2d\Sigma}$$

按照这个思路，首先第一步，就是先设置合适的先验，然后求出后验分布<b>$$\pi (\mu_1,\mu_2,\Sigma |x,y)$$</b> 。目前看来，可以先试一试从Andeson的经典教材中的结果入手，先验设置成正态加逆威沙特分布的组合试一试。
